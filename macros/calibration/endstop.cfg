[gcode_macro ENDSTOPS_CALIBRATION]
description: Endstops Phase Calibration
gcode:
    {% if printer.idle_timeout.state == "Printing" %}
        RESPOND TYPE=error MSG="This macro cannot be used while printing!"
    {% else %}
        HOME
        {% for tries in range(1, (6 + 1)) %}
            ABSOLUTE
            G0 Z6.66
            G0 X110 Y110
            INCREMENTAL
            G2 I20 J20 F6000
            HOME
            M400
        {% endfor %}
        ENDSTOP_PHASE_CALIBRATE stepper=stepper_x
        ENDSTOP_PHASE_CALIBRATE stepper=stepper_y
        ENDSTOP_PHASE_CALIBRATE stepper=stepper_z
        M400
        HOME
  {% endif %}